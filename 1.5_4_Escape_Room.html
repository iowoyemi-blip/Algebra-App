<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Rational Exponents Escape Room â€” Student</title>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
<style>
  body { font-family: system-ui, sans-serif; margin: 0; background: #fff; color: #111; }
  header { padding: 16px; border-bottom: 1px solid #ddd; background: #f9fafb; }
  h1 { margin: 0 0 6px; font-size: 24px; }
  p.sub { margin: 0; color: #555; }
  .rooms { max-width: 960px; margin: 20px auto; display: grid; gap: 20px; }
  .room { border: 1px solid #ddd; border-radius: 12px; overflow: hidden; background: #fff; box-shadow: 0 2px 8px rgba(0,0,0,.04); opacity: 1; }
  .room.locked { opacity: .5; pointer-events: none; }
  .room .title { background: #f3f4f6; padding: 12px 16px; border-bottom: 1px solid #ddd; display:flex; justify-content:space-between; }
  .room .content { padding: 16px; }
  .problem { margin-bottom: 14px; padding: 12px; border: 1px solid #eee; border-radius: 8px; background: #fff; }
  .idx { font-weight: bold; margin-bottom: 6px; }
  .q { margin-bottom: 8px; }
  .input-area { display: flex; gap: 8px; align-items: center; }
  input[type=text] { flex: 1; padding: 8px 10px; border: 1px solid #ccc; border-radius: 8px; }
  button.small { padding: 6px 10px; font-size: 13px; border: 1px solid #ccc; border-radius: 8px; background: #fff; cursor: pointer; }
  .feedback { font-size: 13px; }
  .ok { color: green; }
  .bad { color: red; }
  .room-footer { padding: 10px 16px; border-top: 1px solid #eee; background: #fafafa; font-size: 13px; }
  .unlock { color: green; font-weight: bold; }
  .katex{font-size:1.15em}
</style>
</head>
<body>
<header>
  <h1>Rational Exponents Escape Room â€” Student</h1>
  <p class="sub">Simplify each expression. Answers must use <b>positive rational exponents only</b> (no radicals). Use <code>/</code> for fractions, e.g., <code>u^(1/6)/3</code>. Press <kbd>Enter</kbd> to check.</p>
</header>
<main class="rooms" id="rooms"></main>

<script>
function renderKatex(el, tex){ try { katex.render(tex, el, {throwOnError:false}); } catch { el.textContent = tex; } }

const ROOMS = [
  { name:"Room 1 â€” Warm-up ðŸŒ¶", problems:[
    {q:'(y^{6})^{2/3}', ans:['y^4']},
    {q:'(49b^{10})^{1/2}\\cdot b^{4}', ans:['7b^9','7*b^9']},
  ]},
  { name:"Room 2 â€” Powers & Products ðŸŒ¶ðŸŒ¶", problems:[
    {q:'(8z^{9})^{4/3}', ans:['16z^12','16*z^12']},
    {q:'(p^{-4}q^{10})^{3/2}', ans:['q^15/p^6','q^15/(p^6)']},
  ]},
  { name:"Room 3 â€” Mix & Match ðŸŒ¶ðŸŒ¶ðŸŒ¶", problems:[
    {q:'\n\left(p^{-2}q^{1/4}\\cdot p^{3}q^{5/4}\right)^{2}', ans:['p^2q^3','p^2*q^3']},
    {q:'3r^{3}\\cdot 9r^{1/2}\\cdot r^{-2}', ans:['27r^(3/2)','27*r^(3/2)','27r^1.5','27*r^1.5']},
  ]},
  { name:"Room 4 â€” Spicy Finish ðŸŒ¶ðŸŒ¶ðŸŒ¶ðŸŒ¶", problems:[
    {q:'(16m^{4})^{-3/2}', ans:['1/(64m^6)','1/(64*m^6)']},
    {q:'\\dfrac{3u^{5/6}}{9u^{2/3}}', ans:['u^(1/6)/3','1/3*u^(1/6)']},
  ]},
];

function k(tex){ const span=document.createElement('span'); span.className='q'; span.dataset.tex=tex; return span; }

function buildRooms(){
  const container=document.getElementById('rooms');
  ROOMS.forEach((room,ri)=>{
    const sec=document.createElement('section');
    sec.className='room'+(ri>0?' locked':'');
    sec.dataset.room=ri;
    sec.innerHTML=`<div class="title"><div>${room.name}</div><div>${ri+1}/4</div></div><div class="content"></div><div class="room-footer">Solve all to unlock next room.</div>`;
    const content=sec.querySelector('.content');
    room.problems.forEach((p,pi)=>{
      const prob=document.createElement('div');
      prob.className='problem';
      prob.dataset.i=pi;
      prob.innerHTML=`<div class="idx">${pi+1}.</div>`;
      const q=k(p.q); prob.appendChild(q);
      const ia=document.createElement('div'); ia.className='input-area';
      ia.innerHTML=`<input type=text placeholder="type your simplified answer"><button class=small type=button>Check</button><span class=feedback></span>`;
      prob.appendChild(ia);
      content.appendChild(prob);
    });
    container.appendChild(sec);
  });
  document.querySelectorAll('.q').forEach(el=>{renderKatex(el,el.dataset.tex)});
}

function checkUnlock(ri){
  const room=document.querySelector(`.room[data-room="${ri}"]`);
  const solved=room.querySelectorAll('.feedback.ok').length;
  const total=ROOMS[ri].problems.length;
  if(solved===total && ri<ROOMS.length-1){
    const next=document.querySelector(`.room[data-room="${ri+1}"]`);
    next.classList.remove('locked');
    room.querySelector('.room-footer').innerHTML='<span class=unlock>Room cleared! Next unlocked âœ…</span>';
  }
}

function init(){
  buildRooms();
  const container=document.getElementById('rooms');
  container.addEventListener('click',e=>{
    const target=e.target; if(!(target instanceof HTMLElement)) return;
    if(target.tagName==='BUTTON'){
      const prob=target.closest('.problem');
      const ri=+target.closest('.room').dataset.room;
      const pi=+prob.dataset.i;
      const val=prob.querySelector('input').value.replace(/\s+/g,'');
      const fb=prob.querySelector('.feedback');
      const acc=ROOMS[ri].problems[pi].ans;
      const ok=acc.some(a=>a.replace(/\s+/g,'')===val);
      if(ok){ fb.textContent='Correct!'; fb.className='feedback ok'; prob.style.borderColor='#86efac'; }
      else { fb.textContent='Try again'; fb.className='feedback bad'; prob.style.borderColor='#fecaca'; }
      checkUnlock(ri);
    }
  });
  container.addEventListener('keydown',e=>{
    if(e.key==='Enter'){
      const prob=e.target.closest('.problem'); if(prob){ prob.querySelector('button').click(); }
    }
  });
}

document.addEventListener('DOMContentLoaded',init);
</script>
</body>
</html>